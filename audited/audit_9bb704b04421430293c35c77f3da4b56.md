### Title
SPRUNGSUI CoinMetadata Mutability Allows Unauthorized Token Information Manipulation

### Summary
The SPRUNGSUI token's `CoinMetadata` object is made publicly shared instead of frozen during initialization, allowing anyone with the `TreasuryCap` to arbitrarily modify the token's name, symbol, description, and icon URL. This deviates from the standard secure pattern used throughout the codebase and enables misleading users through corrupted token metadata that affects protocol perception and UI/UX display.

### Finding Description

The vulnerability exists in the `init()` function of the SPRUNGSUI token module: [1](#0-0) 

**Root Cause**: Line 17 uses `transfer::public_share_object(metadata)` instead of the secure pattern `transfer::public_freeze_object(metadata)`. This makes the `CoinMetadata<SPRUNGSUI>` object mutable rather than immutable.

**Why Protections Fail**: 
- The Sui framework's `coin` module provides functions (`update_name`, `update_symbol`, `update_description`, `update_icon_url`) that require both a mutable `CoinMetadata` reference and a `TreasuryCap` for authorization
- By using `public_share_object`, the metadata accepts mutable references from any transaction
- The `TreasuryCap` is transferred to `ctx.sender()` (the deployer) on line 18, giving them modification capability
- No access control exists within the SPRUNGSUI module itself

**Execution Path**:
1. Module deployment triggers `init()`, creating `TreasuryCap` and `CoinMetadata`
2. Deployer receives `TreasuryCap` via `public_transfer`
3. Deployer (or anyone who later obtains the `TreasuryCap`) can directly call Sui framework functions:
   - `coin::update_name<SPRUNGSUI>(&treasury_cap, &mut metadata, new_name)`
   - `coin::update_symbol<SPRUNGSUI>(&treasury_cap, &mut metadata, new_symbol)`
   - `coin::update_description<SPRUNGSUI>(&treasury_cap, &mut metadata, new_description)`
   - `coin::update_icon_url<SPRUNGSUI>(&treasury_cap, &mut metadata, new_url)`

**Contrast with Secure Pattern**: The project's own CERT token and all test coins use the correct pattern: [2](#0-1) [3](#0-2) [4](#0-3) [5](#0-4) 

### Impact Explanation

**User Perception Corruption**:
- Token metadata (name, symbol, description, icon) is displayed in all wallet UIs, block explorers, and dApps
- Malicious modification can rebrand SPRUNGSUI to appear as a different token, a scam, or have offensive content
- Users rely on this metadata to identify tokens before transactions

**Protocol Trust Damage**:
- Suilend's staking mechanism uses SPRUNGSUI as the liquid staking token for SUI reserves
- Metadata corruption undermines user confidence in the entire Suilend/Volo integration
- Reputational damage extends beyond just the token to the entire protocol

**UI/UX Disruption**:
- Integration partners and front-ends display corrupt information
- Users may refuse to interact with the token due to suspicious metadata
- Support burden increases from user confusion

**Severity Justification**: Medium severity because while no direct fund theft occurs, the impact on user trust, protocol reputation, and operational reliability is concrete and measurable. The manipulation affects all users viewing the token and undermines protocol integrity.

### Likelihood Explanation

**Attacker Capabilities**:
- The module deployer automatically possesses the `TreasuryCap` after deployment
- Between deployment and the call to `init_staker()`, a window exists for metadata modification
- If the `TreasuryCap` is ever accessible (e.g., extracted from staking system), modification remains possible

**Attack Complexity**: Trivial
- Direct calls to Sui framework functions
- No complex transaction sequences required
- No need to bypass access controls (the deployer legitimately has the capability)

**Feasibility Conditions**: 
- Requires access to the `TreasuryCap` (guaranteed for deployer at initialization)
- Metadata must be shared rather than frozen (current implementation)
- No additional preconditions needed

**Economic Rationality**:
- Attack cost: Only gas fees for update transactions
- No economic barriers or constraints
- Potential benefit: Phishing, social engineering, reputation damage to competitors

**Detection Constraints**:
- Metadata changes are visible on-chain but users may not monitor for changes
- No protocol-level alerts for metadata modifications
- Changed metadata appears legitimate in all interfaces

**Probability**: High - The vulnerability is immediately exploitable by the deployer with minimal cost and effort.

### Recommendation

**Code-Level Mitigation**:
Replace line 17 in `sprungsui.move`:
```
// Current (vulnerable):
transfer::public_share_object(metadata);

// Should be:
transfer::public_freeze_object(metadata);
```

This makes the `CoinMetadata` immutable after creation, preventing all modification attempts even with the `TreasuryCap`.

**Invariant Check**:
Add a deployment validation script that verifies all token metadata objects in the protocol are frozen, not shared. Check during CI/CD:
```
assert!(object::is_immutable(metadata_object_id), "Token metadata must be immutable");
```

**Test Cases to Prevent Regression**:
1. Verify SPRUNGSUI metadata is frozen after deployment
2. Attempt to call `coin::update_*` functions and confirm they fail
3. Compare SPRUNGSUI initialization pattern with CERT and other tokens
4. Add integration test that validates metadata immutability for all protocol tokens

### Proof of Concept

**Required Initial State**:
- SPRUNGSUI module deployed
- Deployer possesses `TreasuryCap<SPRUNGSUI>`
- Metadata shared via `public_share_object`

**Transaction Steps**:
```
1. Deploy sprungsui module
   → TreasuryCap transferred to deployer
   → CoinMetadata shared publicly

2. Deployer executes:
   coin::update_name<SPRUNGSUI>(
     &treasury_cap,
     &mut metadata,  // Mutable reference works because metadata is shared, not frozen
     b"FAKE TOKEN"
   )

3. Deployer executes:
   coin::update_symbol<SPRUNGSUI>(
     &treasury_cap,
     &mut metadata,
     b"SCAM"
   )

4. Verify in any wallet/explorer:
   → Token now displays as "FAKE TOKEN (SCAM)"
   → Users see corrupted information
```

**Expected vs Actual Result**:
- **Expected (Secure)**: Metadata update transactions fail because object is frozen
- **Actual (Vulnerable)**: Metadata update transactions succeed, corrupting token information

**Success Condition**: 
Token metadata changes persist on-chain and are visible in all interfaces querying the `CoinMetadata<SPRUNGSUI>` object, demonstrating successful exploitation of the mutable metadata vulnerability.

### Citations

**File:** volo-vault/local_dependencies/suilend_d/sprungsui/sources/sprungsui.move (L6-19)
```text
    fun init(witness: SPRUNGSUI, ctx: &mut TxContext) {
        let (treasury, metadata) = coin::create_currency(
            witness, 
            9, 
            b"", 
            b"Staked SUI", 
            b"", 
            option::none(),
            ctx
        );

        transfer::public_share_object(metadata);
        transfer::public_transfer(treasury, ctx.sender())
    }
```

**File:** liquid_staking/sources/cert.move (L59-59)
```text
        transfer::public_freeze_object(metadata);
```

**File:** volo-vault/tests/test_coins.move (L22-22)
```text
        transfer::public_freeze_object(metadata);
```

**File:** volo-vault/tests/test_coins.move (L53-53)
```text
        transfer::public_freeze_object(metadata);
```

**File:** volo-vault/tests/test_coins.move (L84-84)
```text
        transfer::public_freeze_object(metadata);
```
