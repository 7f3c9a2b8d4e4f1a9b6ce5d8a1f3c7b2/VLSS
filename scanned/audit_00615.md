# Issue While Starting New Epoch In Farming

## Summary
The report states that there is a bug in the code related to ending and starting epochs in the farming move function of the thala_protocol. The bug occurs when an epoch ends earlier than the specified time and the code sets the epoch end time to the current time, even though the epoch has already ended. This makes it impossible to start a new epoch until the specified start time is reached. The suggested fix is to set the epoch end time to the current time instead. This issue has been addressed in the latest patch.

## Details
## Epoch Management in thala_protocol/farming.move

The `end_epoch` function in `thala_protocol/farming.move` ends the currently running epoch in order to start a new epoch. 

## Behavior

- If an epoch ends earlier than `epoch_end_seconds`, the code sets `farming.epoch_end_seconds` to `epoch_now`.
- If the current epochâ€™s starting time is in the future and an attempt is made to end this epoch, `farming.epoch_end_seconds` is set to `farming.epoch_start_seconds`, which refers to that future time. Consequently, even though the epoch has ended, it becomes impossible to start another epoch until we reach `farming.epoch_start_seconds`.

## Remediation

To avoid issues, set `farming.epoch_end_seconds` to `timestamp::now_seconds()` instead, particularly if the epoch ended earlier than `epoch_end_seconds`.

## Patch

This issue was fixed in commit `af5fc4a` by setting `farming.epoch_end_seconds` to `timestamp::now_seconds()`.
