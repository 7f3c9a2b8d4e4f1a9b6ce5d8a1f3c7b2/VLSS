# [M-01] Admin role evasion risk

## Summary
This bug report discusses a problem with the function `AccountModule::revokeAccountPermission` which is used to remove permissions from a user. A malicious admin could take advantage of this by using the function `AccountModule::grantAccountPermission` to assign admin permissions to another controlled account before their own permissions are revoked. This could result in the malicious admin retaining access to the system through the newly empowered user. The severity of this bug is high, but the likelihood is low. To prevent this from happening, it is recommended to restrict the capability to assign admin roles to only the system owner.

## Details
## Severity

**Impact:** High

**Likelihood:** Low

## Description

The function `AccountModule::revokeAccountPermission` is designed to remove permissions from a user. However, a malicious admin could preemptively execute a front-run by calling `AccountModule::grantAccountPermission` to assign admin permissions to another controlled account before their own permissions are revoked. Consider this scenario:

1. Permissions are being revoked for an admin using the function `AccountModule::revokeAccountPermission`.
2. The malicious admin performs a front-run, executing the function `AccountModule::grantAccountPermission` to assign admin privileges to another controlled user.
3. The transaction from step 1 completes, but the malicious admin retains access through the newly empowered user.

## Recommendations

It is advisable to restrict the capability to assign admin roles exclusively to the system owner.
