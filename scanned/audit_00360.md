# Inadvertent Locking Of Tokens In Incorrect Chain

## Summary
No summary provided.

## Details
## Token Transfer Validation in Bridge System

The `bridge::send_token` function permits users to specify a `target_chain` parameter, indicating the blockchain network to which they wish to send their tokens. However, it neglects to verify whether the specified target chain is part of a valid route in the Move Bridges system.

> _packages/bridge/sources/bridge.move rust_

## Function Definition

```rust
public fun send_token<T>(
    self: &mut Bridge,
    target_chain: u8,
    target_address: vector<u8>,
    token: Coin<T>,
    ctx: &mut TxContext
) {
    [...]
    // create bridge message
    let message = message::create_token_bridge_message(
        inner.chain_id,
        bridge_seq_num,
        address::to_bytes(tx_context::sender(ctx)),
        target_chain,
        target_address,
        token_id,
        amount,
    )
};
```

Without validating the target chain against a predefined route map or routing logic, users risk inadvertently selecting a target chain incapable of processing token transfers or lacking interoperability with the source chain. This effectively locks the tokens on that chain, preventing them from being claimed by their intended recipients.

## Remediation

Implement validation mechanisms within `send_token` to ensure that the target chain specified by users is part of a valid route in the Move Bridges system.

## Patch

Fixed in PR #16960.

Â© 2024 Otter Audits LLC. All Rights Reserved. 9/19.
