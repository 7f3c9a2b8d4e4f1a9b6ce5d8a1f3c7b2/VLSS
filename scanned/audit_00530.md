# CSP Requires Strictness

## Summary
No summary provided.

## Details
## Current CSP Implementation

The current CSP correctly implements the `script-src` directive. Still, attackers may use different types of HTML injection techniques to leak data, such as a CSS injection or changing the page base URI.

## CspHelmet.ts (TypeScript)

```typescript
const scriptSrc = [`'nonce-\${nonce}'`, "'strict-dynamic'"];
const directives = {
  scriptSrc,
};
const allowedSrc = ['/assets/', 'https://www.googletagmanager.com/'];
const scriptTags = document.getElementsByTagName('script');

if (import.meta.env.DEV) {
  allowedSrc.push('/src/index.jsx');
  directives.scriptSrcElem = ['localhost:5173'];
}

for (let i = 0; i < scriptTags.length; i++) {
  if (allowedSrc.find((src) => scriptTags[i].getAttribute('src')?.startsWith(src))) {
    scriptTags[i].setAttribute('nonce', nonce);
  }
}
```

## Remediation

Add more strict CSP directives. This includes `object-src`, `base-uri`, and `style-src`.
