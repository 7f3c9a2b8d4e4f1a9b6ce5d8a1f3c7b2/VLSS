# Code Refactoring

## Summary
No summary provided.

## Details
## Current Findings

1. Currently, no function exists that reverses the suspension of the `Master<T>` object. This lack of finer-grained control over the status of `Master<T>` objects results in inefficiencies in handling content moderation and enforcement actions.
   
2. In the current implementation of `profile::borrow_master` and `profile::update_*`, the check that verifies whether the sender (`ctx.sender`) exists in the authorization table utilizing `self.authorizations.contains(ctx.sender)` may be removed and instead performed with `access_rights`, which internally also checks for the existence of the sender in the authorization table.
   
   > _move/sources/profile.moverust_
   ```rust
   /// Borrows Master<T> temporarily with a Promise to return it back.
   public fun borrow_master<T: drop>(
       self: &mut Profile, master: Receiving<Master<T>>, ctx: &mut TxContext
   ): (Master<T>, Promise) {
       // Check whether sender exists in authorization table.
       assert!(
           self.authorizations.contains(ctx.sender()),
           ENotAuthorized
       );
       // Users that have access above the BORROW_ACCESS threshold can borrow the master
       assert!(
           *self.authorizations.borrow(ctx.sender()) >= BORROW_ACCESS,
           EInvalidAccessRights
       );
       [...]
       (master, promise)
   }
   ```

3. `profile::admin_receive` grants the holder of the `AdminCap` capability the ability to receive any object of type `T` from a user's profile. This grants the admin broad access to receive various types of objects without restriction.

---

## Recd Group Audit 05 — General Findings

## Remediation

1. Add a function that will enable the admin to revert the suspension of the `Master<T>` object.
2. Eliminate the authorization check by directly utilizing `access_rights`, which internally verifies the existence of the sender in the authorization table.
3. Split `admin_receive` into two separate functions:
   - **admin_receive_master**: This function will specifically handle the receiving of `Master<T>` objects from user profiles.
   - **admin_receive_receipt**: This function will specifically handle the receiving of `Receipt` objects from user profiles.

## Patch

1. Fixed in `3c6e2ec`.
2. Fixed in `3dbae09` and `9257af0`.
3. Fixed in `116c464`.

© 2024 Otter Audits LLC. All Rights Reserved. 11/14
