# Invalid Threshold range

## Summary
No summary provided.

## Details
## Multisig Implementation and Validation

The threshold represents the minimum number of signatures required for authenticating a transaction. The Aptos multisig implementation validates that the threshold is not zero.

## Code Snippet

The following Rust implementation is found in `aptos-core/crates/aptos-crypto/src/multied25519.rs`:

```rust
impl MultiEd25519PublicKey {
    /// Construct a new MultiEd25519PublicKey.
    ///
    /// --- Rules ---
    /// a) threshold cannot be zero.
    /// b) public_keys.len() should be equal to or larger than threshold.
    /// c) support up to MAX_NUM_OF_KEYS public keys.
    pub fn new(
        public_keys: Vec<Ed25519PublicKey>,
        threshold: u8,
    ) -> std::result::Result<Self, CryptoMaterialError> {
        let num_of_public_keys = public_keys.len();
        if threshold == 0 || num_of_public_keys < threshold as usize {
            Err(CryptoMaterialError::ValidationError)
        } else if num_of_public_keys > MAX_NUM_OF_KEYS {
            Err(CryptoMaterialError::WrongLengthError)
        } else {
            Ok(MultiEd25519PublicKey {
                public_keys,
                threshold,
            })
        }
    }
}
```

## Remediation

Add an assertion check to ensure that the threshold is greater than 0.

### Diff

The changes can be seen in the following diff for `move/sources/creator.move`:

```diff
--- a/move/sources/creator.move
+++ b/move/sources/creator.move
@@ -540,6 +540,10 @@ module msafe::creator {
     let owners_count = vector::length(&owners);
     assert!(owners_count > 1, EOWNERS_LESS_THAN_TWO);
     Momentum Safe Audit 04 | Vulnerabilities
     assert!(owners_count <= MAX_MSAFE_OWNERS_LIMIT,
         ,→ EMSAFE_OWNERS_EXCEED_LIMIT);
+    
+    // replace the 1337 with invalid threshold error code
+    assert!((threshold as u64) > 0, 1337);
+    
     assert!((threshold as u64) <= owners_count,
         ,→ ETHRESHOLD_BEYOND_PUBLIC_KEYS);
     let public_keys = get_public_keys(&owners);
```

## Patch

The issue has been fixed in commit `921ad74`.
