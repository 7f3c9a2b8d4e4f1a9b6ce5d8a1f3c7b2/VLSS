# Missing Validation Logic

## Summary
No summary provided.

## Details
## Asset Management Validation Issues in Metastable Pool

## 1. Absence of Decimal Validation

There is an absence of validation for asset decimals when creating a metastable pool in `pool::validate_assets_metadata`. Currently, the function only includes a check for the allowed decimal range for assets in Stable pools. This will result in inconsistent handling of token amounts, as scaling or interacting with the assets within the pool may become inaccurate.

```rust
>_ thalaswap_v2/sources/pool.move rust
fun validate_assets_metadata(metadata: vector<Object<Metadata>>, pool_type: u8): bool {
[...]
if (pool_type == POOL_TYPE_STABLE) {
// Check that pool decimals are within bounds
let j = 0;
while (j < num_assets) {
let x = vector::borrow(&metadata, j);
let decimals = fungible_asset::decimals(*x);
if (decimals > MAX_STABLE_DECIMALS_SUPPORTED ||
,→ decimals<MIN_STABLE_DECIMALS_SUPPORTED) return false;
j = j + 1;
};
};
[...]
}
```

## 2. Flashloan Amount Validation

The assert condition in `pools::flashloan` checks that the specified amount for each asset in the flashloan does not exceed the available pool balance. However, it utilizes the `<=` condition which permits borrowing the entire balance of an asset in the pool. This may result in a temporary drainage of the entire pool’s liquidity for the duration of the flashloan.

```rust
>_ thalaswap_v2/sources/pool.move rust
public fun flashloan(pool_obj: Object<Pool>, amounts: vector<u64>):
,→ (vector<FungibleAsset>, Flashloan) acquires PauseFlag, Pool {
[...]
vector::zip(pool.assets_metadata, amounts, |metadata, amount| assert!(amount <=
primary_fungible_store::balance(pool_addr, metadata),
ERR_POOL_FLASHLOAN_INVALID_AMOUNT));
,→
,→
[...]
}
```

## Remediation

1. Ensure to validate the decimal range for metastable pools as well in `validate_assets_metadata`.
2. Modify the assert condition to strictly check that the flashloan amount is less than the pool balance (`<` instead of `<=`).

## Patch

1. Fixed in commit `19dc5f1`.
2. Fixed in commit `7df3ae8`.
