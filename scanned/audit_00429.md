# Duplicate Address Prevention

## Summary
No summary provided.

## Details
## Wallet Initialization Duplicate Address Check

When initializing a new wallet, a list of owner addresses is provided. This vector should be explicitly checked for duplicate addresses.

## Remediation

Define a helper function in the `utils.move` which checks if a given vector has duplicate entries.

### `utils.move` - RUST

```rust
public fun has_unique_entries(v: &vector<address>): bool {
    let temp = vector::empty<address>();
    let i = 0;
    while (i < vector::length(v)) {
        let element = *vector::borrow(v, i);
        if (!vector::contains(&temp, &element)) {
            vector::push_back(&mut temp, element);
        };
        i = i + 1
    };
    vector::length(v) == vector::length(&temp)
}
```

### Test Function

```rust
#[test]
#[expected_failure]
fun test_unique() {
    let v = vector::empty<address>();
    vector::push_back(&mut v, @0x1);
    vector::push_back(&mut v, @0x2);
    vector::push_back(&mut v, @0x1);
    assert!(has_unique_entries(&v), 1337);
}
```

Use the function to check for duplicate owners of a Momentum Safe in `init_wallet_creation_internal`.

## Code Diff

```diff
--- a/move/sources/creator.move
+++ b/move/sources/creator.move
@@ -538,6 +538,8 @@ module msafe::creator {
     ) acquires PendingMultiSigCreations, MultiSigCreationEvent {
         // Check the input parameters.
         let owners_count = vector::length(&owners);
+        // replace 1337 with error code for dup owners
+        assert!(utils::has_unique_entries(&owners), 1337)
         assert!(owners_count > 1, EOWNERS_LESS_THAN_TWO);
```

## Patch

Fixed in commit `6f30e62`.
