# Lame Coin DOS

## Summary
The bug report describes an issue in the stake::register_staking_account function where a duplicate call occurs when a new user tries to register a Lame coin. This causes the second register call to fail, preventing the user from creating a staking account and causing a Denial of Service. The suggested solution is to remove the extra register call and this issue has been addressed in a recent commit.

## Details
## Duplicate Call Issue in `register_staking_account` Function

In the `stake::register_staking_account` function, a duplicate call occurs when a new user tries to register a Lame coin. This would fail in the second register call (duplicated call), as the coin is already registered under the user in the first register call.

## Code Snippet

```rust
public entry fun register_staking_account(account: &signer) {
    [..]
    if (!coin::is_account_registered<Lame>(addr)) {
        coin::register<Lame>(account);
        coin::register<Lame>(account);
    };
    [..]
}
```

This would cause a Denial of Service, as the new user will not be able to create a staking account.

## Remediation

Removing the extra register call will mitigate this issue.

## Patch

This patch was addressed in the commit `691cbea4`.

Â© 2022 OtterSec LLC. All Rights Reserved. 10 / 22
