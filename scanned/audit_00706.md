# Sanity Check Oracle Hash Size

## Summary
No summary provided.

## Details
## Hashes for Packet Sizes

Hashes for the packet sizes are usually 32 bytes, so it’s worth asserting packet size while submitting the packet.

## Remediation

Assert the hash size in the `oracle_submit` function.

**File:** `sources/app/oracle.move`
```move
public fun oracle_submit<ORACLE>(hash: vector<u8>, confirmations: u64,
_cap: &OracleCapability<ORACLE>) acquires OracleStore,
GlobalStore {
    assert!(vector::length<u8>(&hash) == 32, EORACLE_INVALID_HASH);
    let addr = type_address<ORACLE>();
}
```

## Patch

This check was added in commit `c89ade4`.

**File:** `sources/msglib/v1/uln_receive.move`
```move
public entry fun oracle_propose(account: &signer, hash: vector<u8>,
confirmations: u64) acquires ProposalStore, EventStore {
    assert_length(&hash, 32);
    [..]
}
```

© 2022 OtterSec LLC. All Rights Reserved. 11 / 16
