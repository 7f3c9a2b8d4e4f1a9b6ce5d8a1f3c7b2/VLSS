# Rebalance Security Checks

## Summary
No summary provided.

## Details
## native_pool::rebalance Function Overview

The function `native_pool::rebalance` does not include calls to the `assert_version` and `when_not_paused` functions.

## Original Implementation

```rust
public entry fun rebalance(self: &mut NativePool, wrapper: &mut SuiSystemState, ctx: &mut TxContext) {
    // calculate total stake of validators
    let validators = validator_set::get_bad_validators(&self.validator_set);
    let unstaked_sui = unstake_amount_from_validators(self, wrapper, MAX_UINT_64, 0, validators, ctx);
    coin::join(&mut self.pending, unstaked_sui);
    
    // stake pool
    stake_pool(self, wrapper, ctx);
}
```

## Remediation

Include calls to the `assert_version` and `when_not_paused` functions in the `native_pool::rebalance` function.

## Updated Implementation

```rust
public entry fun rebalance(self: &mut NativePool, wrapper: &mut SuiSystemState, ctx: &mut TxContext) {
    // calculate total stake of validators
    + assert_version(self);
    + when_not_paused(self);
    
    let validators = validator_set::get_bad_validators(&self.validator_set);
}
```

## Patch Information

Fixed in commit **8099e49**.
