# Missing State Verification

## Summary
No summary provided.

## Details
## Ride Cancellation and State Verification Issues

The functions `driver_cancel_ride`, `rider_cancel_ride`, and `admin_cancel_ride` lack the verification of the current ride state. This absence of state verification may result in a driver canceling a ride even after the rider has already canceled the same ride via `rider_cancel_ride`, or vice versa. This may allow either the rider or driver to falsely set the `on_ride` value to false. Additionally, an admin may cancel a ride at any point, regardless of its current state.

## Code Snippet

```rust
public fun driver_head_to_pick_up(driver: &Driver, ride: &mut Ride) {
    assert!(driver.driver_address == *option::borrow<address>(&ride.driver), EDriverDoesNotMatchRide);
    ride.state = RideStatusDriverHeadingToPickUpPoint;
}
```

Furthermore, there is a similar lack of state validation in `driver_head_to_pick_up` as shown above, where the function fails to check if the driver is currently engaged in a different ride prior to initiating a new ride. This results in an overlap, where the same driver is assigned to multiple rides simultaneously.

## Remediation

Before allowing a cancellation, check the current state of the ride to ensure that it is in a cancellable state. Additionally, in `driver_head_to_pick_up`, check if `on_ride = true` to prevent drivers from initiating a ride while they are already engaged in an ongoing ride.

## Patch

Fixed in commit `9ad3d47`.
