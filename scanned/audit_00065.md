# Security Levels Lack Flexibility

## Summary
No summary provided.

## Details
**Update**
"Acknowledged" by the client. The client provided the following explanation:

> Keep it simple for manager to pause according to different severity level.

**File(s) affected:**`bucket_cdp/sources/vault.move`

**Description:** The vault implements a three-level security system that provides insufficient granularity for emergency responses. Level 0 allows all operations, level 1 blocks everything, and level 2 blocks borrowing, repaying, and withdrawing while still allowing deposits and liquidations. This design may force administrators to disable critical functions unnecessarily.

The current implementation prevents nuanced responses to specific vulnerabilities. At level 1, even beneficial actions like debt repayments and liquidations are blocked, which could worsen a crisis by preventing deleveraging and position cleanup. At level 2, repayments are blocked alongside withdrawals and borrows, preventing users from voluntarily reducing their debt during emergencies. A withdrawal vulnerability should not require stopping repayments, and a borrow exploit shouldn't prevent users from improving their positions.

**Recommendation:** We suggest implementing a bitmap-based permission system where each operation can be individually enabled or disabled. For example, use bit flags for deposit (0x1), withdraw (0x2), borrow (0x4), repay (0x8), and liquidate (0x10). This allows precise control during emergencies, such as disabling only withdrawals while maintaining liquidations and repayments to preserve protocol health.
