# Inaccurate MAX_MSAFE_OWNERS_LIMIT

## Summary
No summary provided.

## Details
## Vulnerability Report

An additional nonce key is added in `derive_multisig_auth_key`. This means that the actual `MAX_MSAFE_OWNERS_LIMIT` should be one less than the Aptos enforced maximum of 32, or a total of 31.

## Code Snippet

```move
move/sources/utils.move RUST
public fun derive_multisig_auth_key(
    pubkeys: vector<vector<u8>>,
    threshold: u8,
    nonce: u64,
    module_address: address
): vector<u8> {
    // Write the owner public keys to buffer.
    let pk_bytes = vector::empty<u8>();
    let i = 0;
    while (i < vector::length(&pubkeys)) {
        vector::append(&mut pk_bytes, *vector::borrow(&pubkeys, i));
        i = i + 1;
    };
    // Write the additional nonce as the last public key.
    vector::append(&mut pk_bytes, nonce_to_public_key(nonce, module_address));
    // Write signature threshold and multi-ed25519 schema identifier.
    vector::push_back(&mut pk_bytes, threshold);
    vector::push_back(&mut pk_bytes, 1);
    // Derive the authentication key from the buffer.
    hash::sha3_256(pk_bytes)
}
```

## Remediation

Change the `MAX_MSAFE_OWNERS_LIMIT` from 32 to 31.

## DIFF

```diff
--- a/move/sources/creator.move
+++ b/move/sources/creator.move
Momentum Safe Audit 04 | Vulnerabilities
@@ -146,7 +146,7 @@ module msafe::creator {
 /// the real-time network situation.
 const MIN_REGISTER_TX_GAS: u64 = 2000;
 const MIN_REGISTER_TX_GAS_PRICE: u64 = 1;
- const MAX_MSAFE_OWNERS_LIMIT: u64 = 32;
+ const MAX_MSAFE_OWNERS_LIMIT: u64 = 31;
 /// Wallet creation information stored under the deployer's account.
 struct PendingMultiSigCreations has key, drop {
```

## Patch

Fixed in commit `353c75e`.
