# Missing Address Size Checks

## Summary
No summary provided.

## Details
## Bridge Encode Payload Structure

Per the encode payload structure for bridges, sizes should be limited to 32 bytes. However, there is no check to ensure addresses are this size.

## File Reference
`sources/app/bridge.move`

```move
// encode payload: packet type(1) + remote token(32) + receiver(32) +
,→ amount(8) + unwarp flag(1)
fun encode_send_payload(dst_coin_addr: vector<u8>, dst_receiver:
,→ vector<u8>, amount_sd: u64, unwrap: bool): vector<u8> {
    let payload = vector::empty<u8>();
    serde::serialize_u8(&mut payload, PSEND);
    serde::serialize_vector(&mut payload, dst_coin_addr);
    serde::serialize_vector(&mut payload, dst_receiver);
    [..]
    payload
}
```

## Remediation
It is recommended to assert address sizes before encoding.

```move
sources/app/bridge.move
assert_bytes32(&dst_coin_addr);
assert_bytes32(&dst_receiver);
```

© 2022 OtterSec LLC. All Rights Reserved. 12 / 16
