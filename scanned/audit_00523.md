# Incorrect Domain Validation

## Summary
No summary provided.

## Details
## getDomain Function Issue

The `getDomain` function incorrectly parses the domain, as any domain that ends in `sui.id` is considered valid according to the function.

## Code Snippet

```typescript
export const getDomain = (hostname: string): string => {
    if (!hostname.endsWith("sui.id")) return "";
    const domainTokens = hostname.split(".");
    if (domainTokens.length < 3) return "";
    
    // not allow move.sui.id
    if (
        domainTokens.length === 3 &&
        domainTokens[domainTokens.length - 3] === MOVE
    ) 
        return "";

    // we don't allow `move.sui.id`, so any domains with suffix `move.sui.id` have at least 4 tokens
    if (domainTokens[domainTokens.length - 3] === MOVE)
        return domainTokens.slice(0, -2).join(".");
    
    return domainTokens.slice(0, -1).join(".");
};
```

## Remediation

Check if the domain ends with `.sui.id` or if it is equal to `sui.id` to ensure that other domains ending with `sui.id` are treated as invalid domains in this application.
