# Avoid Division By Zero

## Summary
No summary provided.

## Details
## Division by Zero Issues

There are two points where division by zero occurs:

1. In `storage::unstake`, a division operation is used to calculate the amount to unstake from the pool in the bunch. If the denominator, the `unstaking_bunch_size` variable, is zero, an arithmetic error would occur.
  
2. In `storage::sorting_key`, the key is calculated using the SUI amount and token amount from the current epoch and the previous epoch. If the denominator, `pool_token_amount(er1) * sui_amount(er2)`, is zero, an arithmetic error would occur.

## Remediation

1. Ensure that `unstaking_bunch_size` is at least one.

   ```move
   storage.move DIFF
   @@ -190,30 +191,35 @@ module lsd::storage {
   let unstaking_bunch_size =
   - math::min(lt::length(&storage_state.stakes), unstaking_bunch_size);
   + math::max(
   + math::min(lt::length(&storage_state.stakes), unstaking_bunch_size),
   + ONE
   );
   let init_unstake_amount = sui_amount_to_unstake / unstaking_bunch_size;
   ```

2. Return zero if the denominator is zero.

   ```move
   storage.move DIFF
   @@ -610,6 +617,10 @@ module lsd::storage {
   +if ((pool_token_amount(er1) as u256) * (sui_amount(er2) as u256) == 0) {
   + return 0
   +};
   ```

## Patch

Fixed in `de5d36f` by preventing the denominator from becoming zero.
