# Excessive Withdrawal Of Staked Amount

## Summary
No summary provided.

## Details
## get_split_amount in Staking

The `get_split_amount` function in staking is designed to determine the amount of staked SUI (StakedSui) that can be withdrawn, considering the need for a specific amount.

## Function Definition

```rust
sources/staking.move RUST
fun get_split_amount(wrapper: &mut SuiSystemState, staked_sui_ref: &StakedSui, 
                     need_amount: u64, current_epoch: u64): (u64, u64) {
    [...]
    // withdraw entire or partial of the staked_sui
    let (left_principal, withdraw_principal) = if (staked_sui_with_rewards <= need_amount) { // withdraw entire StakedSui
        (0, staked_sui_with_rewards)
    } else { // split StakedSui and only withdraw partial
        let withdraw_principal = util::mul_div(need_amount, principal, staked_sui_with_rewards) + 1;
        let left_principal = principal - withdraw_principal;
        if (withdraw_principal >= MIN_STAKING_THRESHOLD && left_principal >= MIN_STAKING_THRESHOLD) { // can be split
            (left_principal, withdraw_principal)
        } else { // can't be split
            (0, staked_sui_with_rewards)
        }
    };
    (left_principal, withdraw_principal)
}
```

## Issue

The issue stems from the existing implementation of `get_split_amount`, where a modest `need_amount` (e.g., 1 MIST) has the potential to trigger the withdrawal of the entire StakedSui, even if the total staked SUI amount is considerably high. This occurs instead of withdrawing only a portion of the staked amount as intended, while keeping the rest staked.

## Remediation

Ensure to modify `get_split_amount` to better handle small values of `need_amount`.

## Patch

Fixed in commit `56a221a`.
