# [M-01] Inconsistencies in Blacklisting logic

## Summary
This bug report discusses inconsistencies in the implementation of full and soft restrictions in the `sdeusd.move` function. These restrictions are meant to prevent certain actions from being taken by restricted users. However, there are some cases where these restrictions can be bypassed. For example, a restricted user can still stake if they point to a non-blocked address as the receiver of the sdeUSD. Additionally, newly minted sdeUSD can still be sent to fully blacklisted addresses in the current epoch. The report recommends implementing additional checks to address these issues.

## Details
_Resolved_

## Severity

**Impact:** Medium

**Likelihood:** Medium

## Description
The implementation of full/soft restrictions in `sdeusd.move` shows some inconsistencies that may allow bypasses of it. The full details are described below.

Finding a full description.
Full restrictions include adding user to an `sdeUSD` deny list, which prevents him from operating those coins via the native mechanism. There is also a soft restriction which is meant to prevent access to some of protocol features.

- In functions `deposit` and `mint`, there is only a check against `is_soft_restricted_staker`. Then sdeUSD is transferred to the `receiver`. However, if a restricted user points out another `receiver` address, they may still be able to stake, as the sdeUSD will be transferred to a non-blocked address.
- For the deposit/mint functions, newly minted sdeUSD can still be sent to an address that is fully blacklisted in the current epoch. This is because the restriction on receiving tokens only takes effect in the following epoch.
- Similar case might also happen with `unstake`, if the user becomes restricted after the cooldown is initiated, as the last check for full restrictions happens in `withdraw_to_silo`, then that user will still be able to unstake the funds and exit the protocol
- Finally, since full restriction implements all features of a soft restriction + extra restrictions, then `is_soft_restricted_staker` could potentially invoke `is_full_restricted_staker` inside, as all full restricted stakers are also soft restricted at the same time (but not all soft restricted are full restricted).

## Recommendations
Consider implementing additional restriction checks according to above points.
