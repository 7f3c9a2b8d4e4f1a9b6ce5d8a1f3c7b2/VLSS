# Absence of Ownership Transfer Recording

## Summary
No summary provided.

## Details
## Issue with process_commands in the Cross-Chain Gateway Protocol

There is an issue within `process_commands` in the Cross-Chain Gateway Protocol, specifically in the handling of ownership transfer calls (`SELECTOR_TRANSFER_OPERATORSHIP`). Currently, the function only records approved token transfer calls but does not record calls to transfer ownership. This omission opens up the possibility of relay attacks. 

> _sources/gateway.moverust

```rust
public entry fun process_commands(
    self: &mut Gateway,
    input: vector<u8>
) {
    [...]
    while (i < commands_len) {
        [...]
        else if (cmd_selector == &SELECTOR_TRANSFER_OPERATORSHIP) {
            if (!allow_operatorship_transfer) {
                continue
            };
            allow_operatorship_transfer = false;
            borrow_mut_validators(self).transfer_operatorship(payload);
        } else {
            continue
        };
    }
}
```

## Scenario

Consider a scenario where there are three sets of owners: A, B, and C. Initially, ownership of some assets is transferred from set A to set B (`setA -> setB`). Later, ownership is further transferred from set B to set C (`setB -> setC`). Now, if ownership transfer calls are not recorded, it creates a vulnerability when ownership is transferred back from set C to set A (`setC -> setA`).

## Remediation

Enhance `process_commands` to record ownership transfer calls (`SELECTOR_TRANSFER_OPERATORSHIP`).

## Patch

Fixed in PR #28.

Â© 2024 Otter Audits LLC. All Rights Reserved. 8/18
