# Transaction Hash Index Pollution

## Summary
No summary provided.

## Details
**Update**
Marked as "Mitigated" by the client. Addressed in: `7d2cb0ed1c29ae8e666fea30b63fb04171da5103`. The client provided the following explanation:

> similar to [DIP-6](https://certificate.quantstamp.com/full/dipcoin-perpetual/ea7e8c75-4423-49da-a381-1d39997cfff7/index.html#findings-qs6), not registry tx_hash through functions directly callable by user

**File(s) affected:**`sub_accounts.move`

**Description:** The protocol maintains a platform-level global transaction index through `TxIndexer` to track all on-chain interactions. However, since `tx_hash` values are arbitrary user input without content verification, malicious or careless users can pollute this index with garbage values. The `TxIndexer.map` stores every submitted `tx_hash` permanently in an unbounded table with no cleanup mechanism.

While the development team intends `tx_hash` to serve as unique identifiers for legitimate transactions, nothing prevents users from submitting random or sequential values or even replaying the same payload with a different hash. An attacker could spam the system with bogus `tx_hash` values to bloat storage.

This issue does not create direct security vulnerabilities but impacts operational costs and index quality. Off-chain indexers and monitoring systems relying on this global transaction index may need to filter or validate entries to distinguish legitimate transaction identifiers from noise.

**Recommendation:** For order-related operations, calculate the order hash using the existing `library::get_hash()` function, which is cryptographically bound to the signed order. For other replay-sensitive operations, similarly construct a hash on-chain from the signed parameters (similar to recommendation in [DIP-6](https://certificate.quantstamp.com/full/dipcoin-perpetual/ea7e8c75-4423-49da-a381-1d39997cfff7/index.html#findings-qs6)).
