# Remove Job DOS

## Summary
The function aggregator::remove_job is not working properly. It is supposed to remove a job from the aggregator_job_data, but it is skipping the execution silently when the job address does not exist in the data. This is a problem because the job_ref_count, which keeps track of the number of references a job has, is not being properly updated. The suggested solution is to abort the function if the job does not exist. The code in the aggregator.move file should be updated to include an assert statement to check if the job is in the data before attempting to remove it.

## Details
## Function Overview

The function `aggregator::remove_job` skips the execution silently when the supplied job address doesn’t exist in `aggregator_job_data`. This should abort because when `aggregator_remove_job_action::actuate` calls this function and skips execution, the following call to decrement the `job_ref_count` will be reduced. The `job_ref_count` is used to keep track of the number of references that a job has. So if a job gets added, the count increases, and the count decreases when removed.

## Code Snippet

```rust
sources/actions/aggregator/aggregator_remove_job_action.move
fun actuate(_account: &signer, params: &AggregatorRemoveJobParams) {
    aggregator::remove_job(params.aggregator_addr, params.job_addr);
    job::sub_ref_count(params.job_addr);
}
```

```rust
public(friend) fun remove_job(addr: address, job: address) acquires AggregatorJobData {
    let aggregator_job_data = borrow_global_mut<AggregatorJobData>(addr);
    let (is_in, idx) = vector::index_of(&aggregator_job_data.job_keys, &job);
    if (!is_in) {
        return;
    };
    [..]
}
```

## Remediation

Abort if the supplied job doesn’t exist.

## Code Snippet

```rust
sources/schemas/aggregator.move
public(friend) fun remove_job(addr: address, job: address) acquires AggregatorJobData {
    let aggregator_job_data = borrow_global_mut<AggregatorJobData>(addr);
    let (is_in, idx) = vector::index_of(&aggregator_job_data.job_keys, &job);
    assert!(is_in, E_JOB_NOT_FOUND);
    [..]
}
```
