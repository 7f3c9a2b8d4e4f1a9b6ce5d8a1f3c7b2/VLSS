# Code Maturity

## Summary
No summary provided.

## Details
## Turbos Finance Audit 05 — General Findings

## Findings

1. In rewarder, `strategy_rewards_settle` may be enhanced by utilizing the existing `is_strategy_registered` instead of conducting a manual check with `linked_table::contains` to prevent redundancy. Since `is_strategy_registered` already includes the logic for verifying if a strategy exists in `manager.strategy_shares`, this approach would streamline the process.

   ```rust
   > _rewarder.move_notrust
   public(friend) fun strategy_rewards_settle(
       manager: &mut RewarderManager,
       rewarder_types: vector<TypeName>,
       strategy_id: ID,
       clock: &Clock
   ): VecMap<TypeName, u128> {
       assert!(linked_table::contains<ID, u128>(&manager.strategy_shares, strategy_id), 
       → EStrategyNotRegistered);
       [...]
   }
   ```

2. There are currently several instances of duplicated data (`sqrt_price`, `liquidity`, `base_clmm_position_id`, and `limit_clmm_position_id`). Updates to these values may not be consistently reflected, resulting in unnecessary complexities when storing the same data in multiple locations.

3. `collect_reward` is not called when closing a vault in the current implementation. As a result, any unclaimed rewards associated with the vault will be left behind, negatively impacting the users.

## Remediation

1. Utilize `is_strategy_registered` instead of `linked_table::contains`.
2. Use `turbos_clmm` to retrieve the above-mentioned values ensuring they are calculated and retrieved from a single source.
3. Call `collect_reward` within `close_vault`.

© 2024 Otter Audits LLC. All Rights Reserved. 18/21  
© 2024 Otter Audits LLC. All Rights Reserved. 19/21  

## Patch

Issue #1 and #2 resolved in 971cfd9.
