# Duplicate Guardian Check

## Summary
No summary provided.

## Details
## Wormhole Guardian Set Implementation

Wormhole implements `guardian_set` by storing elements in an array. This implementation does not guarantee the uniqueness of guardians within the set. It allows room for governance mistakes, leading to adding the same guardian in the set more than once. Such mistakes would grant specific guardians greater voting power, potentially leading to decentralization concerns.

## Remediation
Check against the updated `guardian_set` to ensure no duplicate entries exist.

### Code Diff
```move
sui/wormhole/sources/resources/guardian_set.move
public fun new(index: u32, guardians: vector<Guardian>): GuardianSet {
+ // Ensure that there are no duplicate guardians.
+ let (i, n) = (0, vector::length(&guardians));
+ while (i < n - 1) {
+ let left = guardian::pubkey(vector::borrow(&guardians, i));
+ let j = i + 1;
+ while (j < n) {
+ let right = guardian::pubkey(vector::borrow(&guardians, j));
+ assert!(left != right, E_DUPLICATE_GUARDIAN);
+ j = j + 1;
+ };
+ i = i + 1;
+ };
GuardianSet { index, guardians, expiration_timestamp_ms: 0 }
}
```

## Patch
Resolved in commit `760db3c`.
