# Discrepancies in Event Emissions

## Summary
No summary provided.

## Details
## Liquidity and Swap Event Issues in thalaswap_v2

## 1. Issue with `add_liquidity_weighted`

In the current implementation of `pool::add_liquidity_weighted`, `AddLiquidityEvent` emits amounts (the raw values of assets initially provided to the function) instead of `remained_assets`, which is the actual amount of assets the user deposited into the pool.

```rust
>_ thalaswap_v2/sources/pool.move rust
public fun add_liquidity_weighted(pool_obj: Object<Pool>, assets: vector<FungibleAsset>):
â†’ (FungibleAsset, vector<FungibleAsset>) acquires PauseFlag, Pool {
    [...]
    event::emit(AddLiquidityEvent {
        pool_obj,
        metadata,
        amounts,
        minted_lp_token_amount: preview.minted_lp_token_amount,
        pool_balances: pool_balances(pool_obj),
    });
    (lp_token, refunds)
}
```

## 2. Issue with `swap_exact_out_stable` and `swap_exact_out_metastable`

In the current implementations of `swap_exact_out_stable` and `swap_exact_out_metastable`, the `amount_in` value logged by the `SwapEvent` is provided by the users. However, the `amount_in` that is passed by the user may differ from the actual `amount_in` needed to achieve the desired output (`amount_out`).

```rust
>_ thalaswap_v2/sources/pool.move rust
public fun swap_exact_out_stable([...]) [...] {
    [...]
    event::emit(SwapEvent {
        pool_obj,
        metadata: pool_assets_metadata(pool_obj),
        idx_in: preview.idx_in,
        idx_out: preview.idx_out,
        amount_in,
        amount_out,
        total_fee_amount: preview.total_fee_amount,
        protocol_fee_amount: preview.protocol_fee_amount,
        pool_balances: pool_balances(pool_obj),
    });
    [...]
}
```

## Remediation

1. Replace `amounts` in `AddLiquidityEvent` with `remained_assets` since it represents the actual assets deposited into the pool.
2. Pass the exact input amount that was actually utilized in the swap (`preview.amount_in`) to `SwapEvent` to ensure proper logging of swap parameters.

## Patch

1. Fixed in `7df3ae8`.
2. Fixed in `19dc5f1`.
