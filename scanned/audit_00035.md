# Vault Name Reuse Enables Impersonation and Fund Theft

## Summary
The client has acknowledged an issue where the protocol does not prevent the reuse of a vault's name after it has been closed and removed. This can lead to a malicious actor creating a new vault with the same name as a reputable one and stealing funds from unsuspecting users. The recommendation is to modify the protocol to keep a record of all vault names that have ever been used and prevent them from being reused. This will ensure the uniqueness and integrity of a vault's identity.

## Details
**Update**
Marked as "Acknowledged" by the client. The client provided the following explanation:

> For on-chain users, they are capable of and should understand that vault_id is the unique identifier. For DAPP users, in addition to displaying vault_id, we will also present key information such as vault creation time, TVL, and performance, and can also issue warnings about vault name reuse. Furthermore, in our design, remove_vault is not executed immediately after a vault is closed; this is only a reserved capability.

**File(s) affected:**`vault.move`

**Description:** The protocol does not prevent the reuse of a vault's name after the original vault has been closed and removed. When `remove_vault()` is called, it completely deletes the vault's name from the `name_to_id` registry. This allows a malicious actor to immediately create a new vault using the exact same name as a previously reputable and successful vault. Unsuspecting users, relying on off-chain information, social media, or outdated frontend data, may then deposit funds into the new, malicious vault, believing they are investing in the original. The attacker can then steal these deposited funds.

**Recommendation:** Modify the `VaultRegistry` to maintain a permanent record of all vault names that have ever been used. Instead of deleting the name from the `name_to_id` table, the remove_vault function should move the name to a new `deprecated_names` table or `VecSet`. The `create_vault()` and `create_vault_by_manager()` functions must then be updated to check against this list of deprecated names, ensuring that a vault name, once used, can never be registered again. This guarantees the uniqueness and integrity of a vault's identity throughout the protocol's entire history.
