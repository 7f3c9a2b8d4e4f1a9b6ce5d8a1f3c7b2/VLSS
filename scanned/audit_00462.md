# Lack Of Version Check

## Summary
No summary provided.

## Details
## Version Check in User-Callable Functions

All user-callable functions perform a version check to ensure they utilize the most recent module whenever the protocol undergoes an upgrade. However, the functions within `accrue_interest.move` do not include this version validation, which may allow them to execute in their previous versions even after a protocol upgrade.

## Remediation

Insert a validation step to confirm the current version by calling `assert_current_version`.

### accrue_interest.move DIFF

```diff
@@ -3,12 +3,16 @@ module protocol::accrue_interest {
+ use protocol::version::{Self, Version};
public fun accrue_interest_for_market(
+ version: &Version,
market: &mut Market,
clock: &Clock,
) {
+ version::assert_current_version(version);
+
let now = clock::timestamp_ms(clock) / 1000;
market::accrue_all_interests(market, now);
}
@@ -19,11 +23,14 @@ module protocol::accrue_interest {
public fun accrue_interest_for_market_and_obligation(
+ version: &Version,
market: &mut Market,
obligation: &mut Obligation,
clock: &Clock,
) {
- accrue_interest_for_market(market, clock);
+ version::assert_current_version(version);
+
+ accrue_interest_for_market(version, market, clock);
obligation::accrue_interests_and_rewards(obligation, market);
}
}
```

## Patch

Fixed in `f090a72`.
