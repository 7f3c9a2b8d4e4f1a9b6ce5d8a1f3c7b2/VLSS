# Utilization of Incorrect Commission Rate

## Summary
Currently, there is a bug in the staking_pool::advance_epoch function where the commission rate is being incorrectly calculated. This happens because the function uses the new commission rate instead of the old one for the current epoch. This results in an incorrect calculation of the operator's commission. To fix this, the commission calculation should use the old commission rate for the current epoch. This issue has been resolved in the latest patch, cc4aaaa.

## Details
## Staking Pool Commission Calculation Issue

The current implementation of `staking_pool::advance_epoch` utilizes the new commission rate when calculating the commission during the epoch advancement process. 

`advance_epoch` checks if there is a pending commission rate for the current epoch. If there is one, it updates the pool’s commission rate to the new value. The function then splits the rewards between the pool’s rewards and the operator’s commission. This is done by utilizing the updated commission rate.

However, the updated commission rate is intended for future epochs and not for the current epoch. Thus, it will result in an incorrect calculation of the operator’s commission.

## Remediation

Ensure that the commission calculation utilizes the old commission rate for the current epoch.

## Patch

Fixed in `cc4aaaa`.
