# Prioritize Inactive Pool

## Summary
No summary provided.

## Details
## Protocol Strategy for Inactive Validator Pools

In the scenario where the protocol holds staked SUI in the staking pool of an inactive validator, it may be inefficient to distribute the unstaking amount to a bunch via `storage::unstake`. 

For instance, letâ€™s assume there are ten in the inactive pool, ten in the active pool, the bunch size is two, and the `unstake_amount` is six. Then, three will be unstaked from the inactive pool and three from the active pool. However, since the inactive pool no longer generates rewards, it would be an economical strategy to unstake all six from the inactive pool.

## Remediation

When the protocol holds inactive pools, it could employ a strategy that prioritizes utilizing the inactive pool instead of collecting the amount determined by dividing the required amount by the bunch size from the pools in the bunch.

In detail, the sorting key of inactive pools is zero. This allows the protocol to count them, which would be in front of `unstaking_deque`. The following code shows if the protocol has inactive pools, it does not use a bunch system.

```diff
storage.move DIFF
@@ -244,7 +256,12 @@ module lsd::storage {
let amount = sui_amount_to_unstake - collected_amount;
// If remainder is less than init unstake amount, we have to
// unstake just remainder.
- let unstake_amount = math::min(init_unstake_amount, amount);
+ let unstake_amount =
+ if (storage_state.inactive_pools_amount == 0) {
+ math::min(init_unstake_amount, amount)
+ } else {
+ amount
+ };
```

## Patch

Fixed in `2eedd09` by preparing the strategy against holding inactive pools.
