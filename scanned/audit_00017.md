# Revoked Exchange Manager Caps Retain Partial Access

## Summary
No summary provided.

## Details
**Update**
Marked as "Fixed" by the client. Addressed in: `8d82558b66daf90dd2700f5b4555e213752db4f0`.

**File(s) affected:**`roles.move`, `perpetual.move`

**Description:** The `roles::set_exchange_manager()` function issues a new `ExchangeManagerCap` without invalidating the previous one. While most privileged functions validate the cap against access control list in the `ProtocolConfig`, the functions `perpetual::transfer_insurance_fund_from_active_to_security()` and `perpetual::transfer_insurance_fund_from_security_to_active()` only check for the cap's existence, allowing holders of revoked caps to continue performing these operations. This effectively creates a two-tier permission system where access to insurance fund transfers can never be revoked, and it is difficult to retrace which actors retain partial access.

**Recommendation:** If the intent is to have a distinct role for insurance fund operations, introduce a dedicated capability (e.g., `InsuranceOperatorCap`). Otherwise, ensure all functions requiring `ExchangeManagerCap` call `roles::check_manager_validity()` to verify the cap is currently active.
