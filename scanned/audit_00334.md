# Lack Of Access Control In Metadata Setters

## Summary
This bug report discusses a problem with the setter functions for Metadata<T> in the master of a project. These functions do not have proper access control mechanisms, allowing anyone to make unauthorized changes to the metadata fields. This poses a security risk as these fields are meant to be controlled by specific users or roles. The report suggests implementing proper access control mechanisms within these setter functions. The bug has been fixed in version b2d7dadb, which requires the master to update the metadata, limiting access to users with at least borrow access to the master and the administrator.

## Details
## Security Risk in Metadata Setters

The setter functions for `Metadata<T>` in master lack access control mechanisms to restrict who may perform updates. This allows anyone to invoke these setter functions to modify the metadata fields, resulting in unauthorized changes. Unrestricted modification of metadata fields poses a security risk, especially since these are supposed to be controlled by specific users or roles.

> _move/sources/master.moverust

## Some examples of the Metadata setter functions

```rust
// === Metadata Setters ===

// Updates the title for given Metadata.
public fun set_title<T>(metadata: &mut Metadata<T>, title: String) {
    metadata.title = title;
}

// Updates the description for given Metadata.
public fun set_description<T>(metadata: &mut Metadata<T>, description: String) {
    metadata.description = description;
}

// Updates the image URL for given Metadata.
public fun set_image_url<T>(metadata: &mut Metadata<T>, image_url: String) {
    metadata.image_url = image_url;
}
```

## Remediation

Implement proper access control mechanisms within these setter functions for `Metadata<T>`.

## Patch

Fixed in b2d7dad by requiring the Master to update the Metadata, which is possible only for users that have at least borrow access to the Master and the administrator.

Â© 2024 Otter Audits LLC. All Rights Reserved. 6/14
