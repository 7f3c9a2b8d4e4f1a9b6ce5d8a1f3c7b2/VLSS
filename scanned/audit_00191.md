# Check staked_lpt_metadata is indeed an xLPT FA in update_farmingL#896 

## Summary
No summary provided.

## Details
## Context
(No context files were provided by the reviewers).

## Description
In the `update_farming` function in `staked_lpt.move`, there is an expectation that the argument `staked_lpt_metadata: Object<Metadata>` represents the FA metadata for an xLPT token. However, there is no check to enforce this expectation, nor a check can be found in the call chains of:

- `update_farming → deposit_internal → deposit.`
- `update_farming → withdraw_internal → withdraw.`

where both `deposit` and `withdraw` are public functions.

This means that a malicious user can create another FA, say `EvilFA`, create a `transfer_ref` associated with the `EvilFA`, mint `EvilFA` tokens however the adversary wants, and call the public `deposit(<store>, evil_fa_asset, evil_fa_transfer_ref)` defined in `staked_lpt.move` (or similarly, call the public `withdraw` function), which will trigger `update_farming` events, even if the user is not interacting with xLPT tokens (whether the farming is meaningful or not is hard to judge though).

## Recommendation
To be on the safe side, it is suggested to implement a check on `staked_lpt_metadata` to ensure it is indeed an xLPT token, in `update_farming` or in both `deposit_internal` and `withdraw_internal`. The check is implicitly enforced in `withdraw_entry` or `deposit_entry` though, via `borrow_global<Management>(object::object_address(&staked_lpt_metadata))`.
