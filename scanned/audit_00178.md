# Code Refactoring

## Summary
No summary provided.

## Details
## Rebalance and Refactor Plan

## Items to Address

1. Enforce a rebalance after `bank::set_utilisation_bps` is called to ensure that the lending system remains within its desired liquidity utilization range.

2. The early return in `bank::deploy` prevents fund deployment if the amount is smaller than the `min_token_block_size`. However, this may result in improper adjustment of the bankâ€™s utilization rate, preventing it from staying within the target utilization range.

   > _File: `steamm/sources/bank/bank.move`_

   ```rust
   fun deploy<P, T, BToken>(
       bank: &mut Bank<P, T, BToken>,
       lending_market: &mut LendingMarket<P>,
       amount_to_deploy: u64,
       clock: &Clock,
       ctx: &mut TxContext,
   ) {
       let lending = bank.lending.borrow();
       if (amount_to_deploy < bank.min_token_block_size) {
           return;
       }
       let balance_to_lend = bank.funds_available.split(amount_to_deploy);
       [...]
   }
   ```

3. Instead of splitting `fee_a` and `fee_b` in `fee::withdraw`, refactor it to utilize `withdraw_all`.

4. Implement `wrapping_add` functionality for the `lifetime_*` tracking values in the pool to ensure that the values will wrap around rather than panic on overflow.

## Remediation

Update the codebase with the above refactors.

## Patch

1. Issue #3 resolved in commit `96f13c5`.
