# MoveIn and moveOut function can be reentered 

## Summary
No summary provided.

## Details
## Context
(No context files were provided by the reviewer)

## Description
The `moveIn` and `moveOut` functions can be called by any address during the internal execution of the main function, rather than being restricted solely to the `internalScope` contract. In a scenario where an external call executed by the `internalScope` passes the control temporarily to a malicious address or interacts with tokens that have on-transfer hooks, an attacker can exploit these callbacks to re-enter the contract and invoke `moveIn` or `moveOut` directly.

This could be abused in multiple ways:
1. To steal any possible net profit that the caller has just accrued since the final verification only checks that net flows remain nonnegative. Consequently, the attacker can reset a profitable tokenâ€™s net flow to zero, siphoning off all the user gains. (Requires an extra approval by the payer).
2. To reset all allowances given beforehand by the payer to 0 by doing a `moveOut` followed by a `moveIn` of the same amount.

## Recommendation
Consider ensuring that only the trusted `internalScope` address can call the `moveIn` and `moveOut` functions.

## Flood
Acknowledged.

## Cantina Managed
Acknowledged.
