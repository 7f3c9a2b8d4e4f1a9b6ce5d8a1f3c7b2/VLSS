# Improper Path Validation And Usage

## Summary
No summary provided.

## Details
## Pancake Dex Helper Function Analysis

In `pancake_dex_helper.move`, the `set_paths` function sets a path to be used when reinvesting Cake rewards, verifying whether the path exists or not. When `idx = 2`, the function checks whether the path `Cake -> AptosCoin -> X` exists. However, in the `get_lp_by_cake` function, when `path = 2`, it uses the path `Cake -> AptosCoin -> Y` to convert the Cake rewards to Y token, which is inconsistent with the validations in the `set_paths` function.

### Code Snippet
```rust
lyf/pancake_dex_helper.move RUST
} else if (idx == 2) {
    assert!(swap::is_pair_created<Cake, MIDToken1>() ||
            swap::is_pair_created<MIDToken1, Cake>(), ERROR_WRONG_PATH);
    assert!(swap::is_pair_created<X, MIDToken1>() ||
            swap::is_pair_created<MIDToken1, X>(), ERROR_WRONG_PATH);
} else {
```

```rust
lyf/pancake_dex_helper.move RUST
} else if (path == 2) {
    let coin_mid = router::swap_exact_x_to_y_direct_external<Cake, MIDToken1>(cake);
    let coin_y_swap = router::swap_exact_x_to_y_direct_external<MIDToken1, Y>(coin_mid);
    
    coin::merge(&mut coin_y, coin_y_swap);
    coin::merge(&mut coin_y, coin::withdraw<Y>(resource_signer, get_my_balance<Y>()));
} else {
```

This inconsistency could potentially cause the `get_lp_by_cake` function to fail. When `path = 2`, the function attempts to convert Cake rewards from `Cake -> AptosCoin -> Y`, but this path may not exist.

## Remediation
To address the inconsistency between the validations in the `set_paths` function and the `get_lp_by_cake` function, we recommend adding an `idx = 3` case to the `set_paths` function, where it checks if the path `Cake -> AptosCoin -> Y` exists. Then, in the `get_lp_by_cake` function, we suggest using the `path = 2` case to convert Cake rewards in the `Cake -> AptosCoin -> X` path, and using the `path = 3` case to convert Cake rewards in the `Cake -> AptosCoin -> Y` path.

## Eternal Finance Audit 04 | Vulnerabilities
### Patch
Fixed in `797a45c`.
