# [M-01] Blocklisted Recipient Credits Are Forcibly Redirected to the Admin, Enabling Custodial Capture of Inbound Transfers

## Summary
The bug report describes an issue in the Aptos adapter that allows the admin to divert funds from a blocklisted recipient to their own account. This happens because the code does not check for blocklisted recipients before transferring funds. The impact of this bug is that the admin can blocklist any wallet and receive all incoming bridge receipts instead. The team has acknowledged the issue and will address it.

## Details
## Severity

Medium Risk

## Description

The receive‑side flow in the Aptos adapter uses `credit(to, amount_ld, src_eid, receive_value)` to unlock funds from the escrow object and move them into the recipient’s primary store. Immediately before the `primary_fungible_store::transfer()` call, the recipient address is obtained by invoking `redirect_to_admin_if_blocklisted()`.

That helper first evaluates `is_blocklisted(wallet)`, which returns `true` only if `Config.blocklist_enabled` is `true` and the address appears in `Config.blocklist`. If the address is blocklisted, `redirect_to_admin_if_blocklisted` emits a `BlockedAmountRedirected` event and returns `get_admin()`.

Otherwise, it returns the original recipient. Because credit uses that returned address as the transfer target and does not revert on a blocklisted recipient, any inbound credit for a blocklisted recipient is deterministically diverted to the current admin account. Outbound sends are separately guarded by `assert_not_blocklisted` in `debit_fungible_asset`, so a blocklisted sender cannot initiate a debit, but a non‑blocklisted sender can still send to a blocklisted recipient and have the funds delivered to the admin.

There is no additional slippage or dust check at this stage that would prevent delivery - the diversion happens unconditionally once the blocklist predicate is `true`.

This behavior is, therefore, active and exploitable by whoever controls `set_blocklist()`, and it materially alters the received funds without reverting the transfer.

## Location of Affected Code

File: [sources/oft_implementation/oft_adapter_fa.move#L46](https://github.com/Chainwith/RWD_BRIDGE/blob/c68e1d39d98b2e819021384771a0bf4722ec5947/sources/oft_implementation/oft_adapter_fa.move#L46)

```move
public(friend) fun credit(
    to: address,
    amount_ld: u64,
    src_eid: u32,
    lz_receive_value: Option<FungibleAsset>,
): u64 acquires OftImpl {
    // Default implementation does not make special use of LZ Receive Value sent; just deposit to the OFT address
    option::for_each(lz_receive_value, |fa| primary_fungible_store::deposit(@oft_admin, fa));

    // Release rate limit capacity for the pathway (net inflow)
    release_rate_limit_capacity(src_eid, amount_ld);

    // unlock the amount from escrow
    let escrow_signer = &object::generate_signer_for_extending(&store().escrow_extend_ref);

    // Deposit the extracted amount to the recipient, or redirect to the admin if the recipient is blocklisted
    primary_fungible_store::transfer(
        escrow_signer,
        metadata(),
        redirect_to_admin_if_blocklisted(to, amount_ld),
        amount_ld
    );

    amount_ld
}
```

## Impact

The admin can blocklist any wallet, and then all inbound bridge receipts to that wallet get credited to the admin address instead.

## Recommendation

If this redirection is intentional for compliance, make it explicit in the docs and UI and require an opt‑in from users. If not desired, replace with a hard revert on credits to blocklisted addresses.

## Team Response

Acknowledged.
