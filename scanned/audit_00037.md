# Vault Denial of Service if Creator Exits in Manager-Created Vaults

## Summary
A bug was reported in a program called `vault.move` that allows creators to withdraw 100% of their shares in their own vaults. This causes a problem when a user's share balance reaches 0 and their position is removed from the system. The `withdraw_preload()` and `fill_withdrawal_requests()` functions contain code that tries to distribute profit sharing fees, but it fails if the creator has already withdrawn their shares. The recommendation is to check if the creator's position exists before attempting to distribute fees and handle the situation gracefully. This bug has been marked as "fixed" by the client.

## Details
**Update**
Marked as "Fixed" by the client. Addressed in: `f615d39764979bcb1ed5e2facc3556702c0f8a11`.

**File(s) affected:**`vault.move`

**Description:** In manager-created vaults, the `creator_minimum_share_ratio` can be set to 0, allowing the creator to withdraw 100% of their shares. When a user's share balance reaches 0, their `Position` object is removed from the `user_positions` table.

However, the `withdraw_preload()` function and `fill_withdrawal_requests()` function both contain logic that unconditionally attempts to borrow the creator's position to distribute profit sharing fees:

```
if (user != vault.creator) {
    vault.user_positions.borrow_mut(vault.creator).add_shares(share_to_creator, share_price);
};
```

If the creator has exited the vault (removed their position), this `borrow_mut` call will fail, causing the transaction to abort.

**Recommendation:** Check if the creator's position exists before attempting to add shares. If the position is missing, handle the fee distribution gracefully (e.g., re-create the position or skip fee distribution).
