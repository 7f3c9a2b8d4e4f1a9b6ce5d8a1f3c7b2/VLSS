# Rewards State Abort

## Summary
No summary provided.

## Details
## Edge Case Description

An edge case occurs when the length of the rewards vector in `user_reward_manager` is less than or equal to the current index `i`. This implies that there are fewer entries in the rewards vector than expected based on the iteration index. However, the `if` condition `(vector::length(&user_reward_manager.rewards) == i)` only executes when the pool rewards is initialized. If the pool reward array is not contiguous, this could trigger an abort.

> _liquidity_mining.move rust_

```rust
fun update_user_reward_manager(
    pool_reward_manager: &mut PoolRewardManager,
    user_reward_manager: &mut UserRewardManager,
    clock: &Clock
) {
    [...]
    while (i < vector::length(&pool_reward_manager.pool_rewards)) {
        let optional_pool_reward = vector::borrow_mut(&mut pool_reward_manager.pool_rewards, i);
        if (option::is_none(optional_pool_reward)) {
            i = i + 1;
            continue;
        };
        let pool_reward = option::borrow_mut(optional_pool_reward);
        if (vector::length(&user_reward_manager.rewards) == i) {
            vector::push_back(&mut user_reward_manager.rewards, option::none());
        };
        [...]
        [...]
    }
}
```

## Remediation

Change the `if` condition to a `while` loop with a less than or equal check (`<=`), ensuring that it keeps appending placeholder entries to the rewards vector until the length of the vector becomes greater than `i`.

## Patch

Fixed in `712853d`.

Â© 2024 Otter Audits LLC. All Rights Reserved. 6/11
