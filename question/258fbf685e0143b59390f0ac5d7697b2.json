[
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: has_authority()] [Authorization Bypass] Can an attacker bypass authority check by manipulating ctx.sender() in a multi-sig or proxy context, allowing unauthorized config updates without proper authorization, leading to aggregator manipulation? (Critical)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: set_authority()] [Authorization Missing] The set_authority() function is public(package) but lacks authority check - can any package module call this to transfer authority to attacker address, bypassing has_authority() checks and gaining full control? (Critical)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: set_configs()] [Authorization Missing] The set_configs() function is public(package) without authority validation - can attacker module within package call this to set malicious configs (min_sample_size=0, max_staleness_seconds=u64::MAX) enabling stale/invalid data acceptance? (Critical)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: set_configs()] [Config Manipulation] Can attacker with package access set min_sample_size=0 via set_configs(), bypassing minimum sample requirements and allowing single oracle update to determine price, enabling price manipulation? (High)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: set_configs()] [Config Manipulation] Can attacker set max_staleness_seconds to u64::MAX via set_configs(), allowing infinitely old oracle data to be accepted as valid, enabling use of manipulated historical prices? (High)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: set_configs()] [Config Manipulation] Can attacker set max_variance=0 via set_configs(), causing all variance checks to fail or allowing any variance to pass, breaking data quality guarantees? (Medium)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: set_configs()] [Config Manipulation] Can attacker set min_responses=0 via set_configs(), allowing aggregator to produce results without any oracle responses, breaking consensus mechanism? (High)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: new()] [Initialization Vulnerability] During new() aggregator creation, can attacker set min_sample_size=0 initially, creating permanently broken aggregator that accepts invalid single-oracle data throughout lifetime? (High)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: set_update()] [Circular Buffer Overflow] In set_update(), curr_idx = (last_idx + 1) % MAX_RESULTS - can attacker trigger wraparound by submitting exactly MAX_RESULTS updates, causing curr_idx to overwrite oldest entry, potentially losing critical price data? (Medium)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: set_update()] [Timestamp Validation Bypass] In set_update() at lines 311-314, check 'if (timestamp_ms < last_result.timestamp_ms)' only compares against last_idx, not most recent timestamp - can attacker submit out-of-order updates that are newer than position [last_idx] but older than position [last_idx-1], bypassing chronological ordering? (High)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: set_update()] [Timestamp Validation Bypass] The timestamp check at line 312 returns silently if timestamp_ms < last_result.timestamp_ms - can attacker with multiple oracles submit older timestamps to specific positions in circular buffer, manipulating median calculation by controlling age distribution? (Medium)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: set_update()] [State Corruption] In set_update(), if results.length() == 0, function pushes and returns at line 306 without updating curr_idx - does this leave curr_idx at stale value, causing next update to overwrite wrong position? (Medium)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: set_update()] [Race Condition] In set_update(), curr_idx is read at line 297 then written at line 334 - in concurrent add_result() calls on shared Aggregator, can race condition cause curr_idx updates to be lost, leading to buffer corruption? (High)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: set_update()] [Buffer Overwrite] At lines 327-331, when results.length() >= MAX_RESULTS, existing result is overwritten - can attacker time submissions to overwrite specific oracle's data right before computation, excluding it from median calculation? (Medium)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: set_update()] [Index Calculation Error] At line 298, curr_idx = (last_idx + 1) % MAX_RESULTS - if last_idx is corrupted to be >= MAX_RESULTS, does modulo still produce valid index or can it cause out-of-bounds access? (High)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: add_result()] [Timestamp Manipulation] In add_result() at line 250, now_ms from clock.timestamp_ms() is used for staleness checks - can attacker manipulate Clock object or submit updates during clock manipulation to bypass max_staleness_seconds validation? (High)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: add_result()] [Silent Failure] At lines 252-256, if compute_current_result() returns None, add_result() silently succeeds without updating current_result - can attacker flood with invalid updates, causing aggregator to stop producing results while appearing functional? (High)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: valid_update_indices()] [Staleness Calculation Error] At line 574, staleness check is '(results[idx].timestamp_ms + max_staleness_ms) < now_ms' - if timestamp_ms + max_staleness_ms overflows u64, does it wrap to small value causing all future updates to be considered stale, DoS attack? (Critical)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: valid_update_indices()] [Staleness Check Bypass] In valid_update_indices() at line 574, loop breaks if ANY element is stale - can attacker place one stale update at strategic position in circular buffer to prevent newer valid updates from being checked, forcing use of older subset? (High)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: valid_update_indices()] [Oracle Deduplication Bypass] At lines 582-585, seen_oracles uses vec_set to track unique oracles - can attacker create multiple oracle IDs that collide in vec_set comparison, allowing single oracle to contribute multiple times as different 'unique' oracles? (Critical)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: valid_update_indices()] [Index Wraparound Bug] At lines 588-592, if idx == 0, it wraps to results.length() - 1 - if results.length() is 0 (shouldn't happen but not validated), does this cause underflow to u64::MAX? (Medium)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: valid_update_indices()] [Iteration Logic Error] At line 565, remaining_max_iterations = u64::min(MAX_RESULTS, results.length()) - if results.length() > MAX_RESULTS due to corruption, does min() cap at MAX_RESULTS leaving some valid entries unchecked? (Low)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: valid_update_indices()] [Backwards Iteration Manipulation] The function iterates backwards from curr_idx at lines 588-592 - can attacker manipulate curr_idx to point to oldest entry, causing iteration to process updates in attacker-favorable order? (Medium)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: compute_current_result()] [Sample Size Bypass] At lines 343-346, if update_indices.length() < min_sample_size, returns None - but can attacker manipulate valid_update_indices() to return exactly min_sample_size malicious updates, bypassing quality checks? (High)",
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/aggregator.move] [Function: compute_current_result()] [Single Update Vulnerability] At lines 348-362, special case for single update (length == 1) returns result without variance/stdev checks - can attacker cause only 1 valid update to pass filters, bypassing all statistical validation? (High)"
]