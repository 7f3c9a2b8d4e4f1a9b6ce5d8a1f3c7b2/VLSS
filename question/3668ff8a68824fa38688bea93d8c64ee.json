[
  "[File: volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/oracle.move] [Function: test_attestations()] [Test Logic\n\n### Citations\n\n**File:** volo-vault/local_dependencies/switchboard_sui/on_demand/sources/schemas/oracle.move (L1-248)\n```text\n\nmodule switchboard::oracle;\n\nconst ATTESTATION_TIMEOUT_MS: u64 = 1000 * 60 * 10; // 10 minutes\nconst VERSION: u8 = 1;\n\npublic struct Attestation has copy, store, drop {\n    guardian_id: ID, \n    secp256k1_key: vector<u8>,\n    timestamp_ms: u64,\n}\n\npublic struct Oracle has key {\n    id: UID,\n    oracle_key: vector<u8>,\n    queue: ID,\n    queue_key: vector<u8>,        \n    expiration_time_ms: u64,\n    mr_enclave: vector<u8>,\n    secp256k1_key: vector<u8>,\n    valid_attestations: vector<Attestation>,\n    version: u8,\n}\n\npublic fun id(oracle: &Oracle): ID {\n    oracle.id.to_inner()\n}\n\npublic fun secp256k1_key(oracle: &Oracle): vector<u8> {\n    oracle.secp256k1_key\n}\n\npublic fun oracle_key(oracle: &Oracle): vector<u8> {\n    oracle.oracle_key\n}\n\npublic fun queue(oracle: &Oracle): ID {\n    oracle.queue\n}\n\npublic fun queue_key(oracle: &Oracle): vector<u8> {\n    oracle.queue_key\n}\n\npublic fun expiration_time_ms(oracle: &Oracle): u64 {\n    oracle.expiration_time_ms\n}\n\npublic fun guardian_id(attestation: &Attestation): ID {\n    attestation.guardian_id\n}\n\npublic fun oracle_secp256k1_key(attestation: &Attestation): vector<u8> {\n    attestation.secp256k1_key\n}\n\npublic fun timestamp_ms(attestation: &Attestation): u64 {\n    attestation.timestamp_ms\n}\n\npublic fun version(oracle: &Oracle): u8 {\n    oracle.version\n}\n\npublic(package) fun new(\n    oracle_key: vector<u8>,\n    queue: ID,\n    queue_key: vector<u8>,\n    ctx: &mut TxContext,\n): ID {\n    let id = object::new(ctx);\n    let oracle_id = *(id.as_inner());\n    let oracle = Oracle {\n        id,\n        oracle_key,\n        queue,\n        queue_key,\n        expiration_time_ms: 0,\n        secp256k1_key: vector::empty(),\n        valid_attestations: vector::empty(),\n        mr_enclave: vector::empty(),\n        version: VERSION,\n    };\n    transfer::share_object(oracle);\n    oracle_id\n}\n\npublic(package) fun new_attestation(\n    guardian_id: sui::object::ID,\n    secp256k1_key: vector<u8>,\n    timestamp_ms: u64,\n): Attestation {\n    Attestation {\n        guardian_id,\n        secp256k1_key,\n        timestamp_ms,\n    }\n}\n\npublic(package) fun add_attestation(oracle: &mut Oracle, attestation: Attestation, timestamp_ms: u64) {\n    oracle.valid_attestations = vector::filter!(oracle.valid_attestations, |a: &Attestation| {\n        a.timestamp_ms + ATTESTATION_TIMEOUT_MS > timestamp_ms && a.guardian_id != attestation.guardian_id\n    });\n    vector::push_back(&mut oracle.valid_attestations, attestation);\n}\n\npublic(package) fun valid_attestation_count(oracle: &Oracle, secp256k1_key: vector<u8>): u64 {\n    vector::count!(&oracle.valid_attestations, |a: &Attestation| {\n        a.secp256k1_key == secp256k1_key\n    })\n}\n\npublic(package) fun enable_oracle(\n    oracle: &mut Oracle, \n    secp256k1_key: vector<u8>,\n    mr_enclave: vector<u8>,\n    expiration_time_ms: u64,\n) {\n    oracle.secp256k1_key = secp256k1_key;\n    oracle.mr_enclave = mr_enclave;\n    oracle.expiration_time_ms = expiration_time_ms;\n}\n\n\n#[test_only]\nfun destroy_oracle(oracle: Oracle) {\n    let Oracle {\n        id,\n        oracle_key: _,\n        queue: _,\n        queue_key: _,\n        expiration_time_ms: _,\n        secp256k1_key: _,\n        valid_attestations: _,\n        mr_enclave: _,\n        version: _,\n    } = oracle;\n    object::delete(id);\n \n }\n\n\n#[test]\nfun test_create_oracle() {\n    use sui::test_scenario;\n    let owner = @0x26;\n    let mut scenario = test_scenario::begin(owner);\n    let ctx = scenario.ctx();\n\n    // just a random key\n    let oracle_key = x"
]